<table style="width:100%;">
<tr>
<td>
<form accept-charset="UTF-8" action="/lumba/setlang" enctype="multipart/form-data" method="post">
<font color="red">(Production server)</font> Game version:  <select id="version" name="game_version">
    <option value="">-</option>
    <% @version_array.each do |row|%>
      <option value="<%= row['NextGameVersion']%>"><%= row['NextGameVersion']%></option>
     <% end%>
  </select>
  <div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="âœ“"></div>
  Choose file to upload:
  <input type="file" name="files[]" multiple>
  <input id="uploadlanguagefile" type="submit" value="Upload" name="commit">
  </form>
</td>
<td>
  <form accept-charset="UTF-8" action="/lumba/setlang" id="downloadlangform" method="post">
  <input id="downloadlanguagefile" type="submit" value="DownloadLanguage" name="commit">
  </form>
</td>
</td>
</tr>
</table>




<table>
<tr>
<td><button type="submit" onclick="exportfileproduction(21, false, '');">Publish Arabic production</button></td>
<td><button type="submit" onclick="exportfileproduction(22, false, '');">Publish English production</button></td>
</tr>
</table>

<table style="width:100%">
<tr>
<form accept-charset="UTF-8" action="/lumba/setlang" id="googlespreadsheetform" method="post">
<td>Google spreadsheet url: <%= text_field_tag 'googleurlRef', @googleurlRef %></td>
<td><input type="button" id="updatefromgoogle" value="UpdateFromGoogle"/> </td>
<td><input type="button" id="exporttogoogle" type="button" value="ExportToGoogle"/></td>
</form>
<td style="width:50%;text-align: right;">
<form action="/lumba/setlang" method="post">
Search code reference:   <%= text_field_tag 'codeRef', @codeRef %>
  <%= submit_tag( "Search" ) %>
</form>
</td>
</tr>
</table>

<br/>


<div id="table-wrapper">
  <div id="table-scroll">
<table class="ex1" style="font-size:13px; color:blue" id="tblsetlang">
    <thead>
      <tr><th><span class="text">codeReference</th><th><span class="text">AR</th><th><span class="text">EN</th></tr>
    </thead>
    <tbody>
     <% @lang_languages.each_hash do |row|%>
        <tr>
          <td width="20%"><div><input type="hidden" value="<%= row['pkID']%>"/><div contenteditable class="codeReference"><%= row['codeReference']%></div></div></td>
          <td width="30%"><div><input type="hidden" value="<%= row['pkID']%>"/><div contenteditable class="ar" DIR="RTL"><%= row['AR'].force_encoding('utf-8')%></div></div></td>
          <td width="30%"><div><input type="hidden" value="<%= row['pkID']%>"/><div contenteditable class="en"> <%= row['EN'].force_encoding('utf-8')%></div></div></td>
        </tr>
     <% end%>
  </tbody>
</table>
</div>
</div>


<script>
$("#version").val('<%= @game_version%>');
  $( "#uploadlanguagefile" ).click(function() {
    if($( "#version" ).val() === "") {
      alert("Please choose game version");
      return false;
    }
  });

$( "#downloadlanguagefile" ).click(function() {
    if($( "#version" ).val() === "") {
      alert("Please choose game version");
      return false;
    }
    else {
      var input = "<input name='game_version' type='hidden' value='" + $( "#version" ).val() + "'>";
      var input1 = "<input name='commit' type='hidden' value='DownloadLanguage'>";
      $('#downloadlangform').append($(input));
      $('#downloadlangform').append($(input1));
      $('#downloadlangform').submit();
    }
  });

$( "#updatefromgoogle" ).click(function() {
    if($( "#version" ).val() === "") {
      alert("Please choose game version");
      return false;
    }
    else {
      $( "#dialog-goolge_form" ).dialog( "open" );
      $( "#confirmgoogleaccount" ).click(function() {
        var input = "<input name='game_version' type='hidden' value='" + $( "#version" ).val() + "'>";
        var input1 = "<input name='commit' type='hidden' value='UpdateFromGoogle'>";
        var input2 = "<input name='googleemail' type='hidden' value='" + $( "#googleemail" ).val() + "'>";
        var input3 = "<input name='googlepassword' type='hidden' value='" + $( "#googlepassword" ).val() + "'>";
        $('#googlespreadsheetform').append($(input));
        $('#googlespreadsheetform').append($(input1));
        $('#googlespreadsheetform').append($(input2));
        $('#googlespreadsheetform').append($(input3));
        $('#googlespreadsheetform').submit();
        $( "#dialog-goolge_form" ).dialog( "close" );
      });
    }
  });

$( "#exporttogoogle" ).click(function() {
    if($( "#version" ).val() === "") {
      alert("Please choose game version");
      return false;
    }
    else {
      $( "#dialog-goolge_form" ).dialog( "open" );
      $( "#confirmgoogleaccount" ).click(function() {
        var input = "<input name='game_version' type='hidden' value='" + $( "#version" ).val() + "'>";
        var input1 = "<input name='commit' type='hidden' value='ExportToGoogle'>";
        var input2 = "<input name='googleemail' type='hidden' value='" + $( "#googleemail" ).val() + "'>";
        var input3 = "<input name='googlepassword' type='hidden' value='" + $( "#googlepassword" ).val() + "'>";
        $('#googlespreadsheetform').append($(input));
        $('#googlespreadsheetform').append($(input1));
        $('#googlespreadsheetform').append($(input2));
        $('#googlespreadsheetform').append($(input3));
        $('#googlespreadsheetform').submit();
        $( "#dialog-goolge_form" ).dialog( "close" );
      });
    }
  });
  $('#version').change(function(){
    var pathname = window.location.pathname;
    post_to_url("/lumba/switchserver/switchversion", { game_version: $(this).val(),currenturl: pathname })
  });
</script>
